<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>📊 Dashboard | SmartSaver</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .card-type-savings { border-left: 5px solid #28a745; }
    .card-type-expense { border-left: 5px solid #007bff; }
  </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="mb-4 text-center">
      <h1>📊 SmartSaver Dashboard</h1>
      <p class="lead">Welcome back, <strong>{{ user.username }}</strong>!</p>
    </div>

    {% if savings or expenses %}
      <div class="row row-cols-1 row-cols-md-2 g-4">

        {% for entry in savings %}
          <div class="col">
            <div class="card shadow-sm card-type-savings">
              <div class="card-body">
                <h5 class="card-title">💰 Savings Plan
                  <form action="{% url 'delete_entry' %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="type" value="savings">
                     <a href="{% url 'generate_ai_tip_entry' %}" class="btn btn-secondary me-2">🧠 Generate AI Tip</a>
                    <input type="hidden" name="id" value="{{ entry.id }}">
                    <button type="submit" class="btn btn-sm btn-outline-danger float-end">🗑️ Delete</button>
                  </form>
                </h5>
                <p class="card-text small text-muted">{{ entry.created_at|date:"Y-m-d H:i" }}</p>
                <p><strong>Goal Amount:</strong> {{ entry.goal_amount }}</p>
                <p><strong>Monthly Required:</strong> {{ entry.monthly_savings_converted }} {{ entry.converted_currency }}</p>
                <p><strong>ETF:</strong> {{ entry.etf_symbol }} - ${{ entry.etf_price }} ({{ entry.etf_change }}%)</p>
              </div>
            </div>
          </div>
        {% endfor %}

        {% for entry in expenses %}
          <div class="col">
            <div class="card shadow-sm card-type-expense">
              <div class="card-body">
                <h5 class="card-title">💸 Expense Analysis
                  <form action="{% url 'delete_entry' %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="type" value="expense">
                    <input type="hidden" name="id" value="{{ entry.id }}">
                     <a href="{% url 'generate_ai_tip_entry' %}" class="btn btn-secondary me-2">🧠 Generate AI Tip</a>
                    <button type="submit" class="btn btn-sm btn-outline-danger float-end">🗑️ Delete</button>
                  </form>
                </h5>
                <p class="card-text small text-muted">{{ entry.created_at|date:"Y-m-d H:i" }}</p>
                <p><strong>Total Spent:</strong> {{ entry.total_amount_spent }}</p>
                <p><strong>Budget:</strong> {{ entry.total_amount_target }}</p>
              </div>
            </div>
          </div>
        {% endfor %}

      </div>
    {% else %}
      <div class="alert alert-info text-center">
        No activity yet. Start planning or analyzing!
      </div>
    {% endif %}

    <div class="mt-5 text-center">
      <a href="{% url 'savings_goal' %}" class="btn btn-success me-2">💰 Plan Savings</a>
      <a href="{% url 'analyze_expenses' %}" class="btn btn-primary me-2">💸 Analyze Expenses</a>
     
      <a href="{% url 'logout' %}" class="btn btn-outline-danger">Logout</a>
    </div>
  </div>
</body>
</html>
